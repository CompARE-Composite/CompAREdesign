# Surv_tte
#########################
surv_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman')
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2, case = case, rho=rho, copula = copula, rho_type=rho_type)
# 14.6
# 3.96
# 4.49
#########################
# Surv_tte
#########################
surv_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman')
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2, case = case, rho=rho, copula = copula, rho_type=rho_type)
# 14.6
# 3.96
# 4.49
#########################
# Surv_tte
#########################
surv_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman')
col()
col
color()
col()
colors()
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2, case = case, rho=rho, copula = copula, rho_type=rho_type)
# 14.6
# 3.96
# 4.49
#########################
# Surv_tte
#########################
surv_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman')
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld')
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2, case = case, rho=rho, copula = copula, rho_type=rho_type)
# 14.6
# 3.96
# 4.49
#########################
# Surv_tte
#########################
surv_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman')
#########################
# Effect size
#########################
# p0_e1=p1; p0_e2=p2; HR_e1=HR1; HR_e2=HR2; beta_e1=beta1; beta_e2=beta2; case = case; rho=rho; copula = copula; rho_type='Spearman'
effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type='Spearman', plot_HR=TRUE)
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld')
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld')
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2, case = case, rho=rho, copula = copula, rho_type=rho_type)
# 14.6
# 3.96
# 4.49
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld')
#'
#' The user can choose between the two most common formulae (Schoendfeld and Freedman) for the sample size calculation for the single components.
#' Schoendfeld formula always be used for the composite endpoint.
#'
#'
#' @references
#' Friedman L.M., Furberg C.D., DeMets D.L. Fundamentals of Clinical Trials. 3rd ed. New York: Springer; 1998.
#' Cortés Martínez, J., Geskus, R.B., Kim, K. et al. Using the geometric average hazard ratio in sample size calculation for time-to-event data with composite endpoints. BMC Med Res Methodol 21, 99 (2021). https://doi.org/10.1186/s12874-021-01286-x
#'
#'
samplesize_tte <- function(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld', subdivisions=20, plot_res=FALSE){
requireNamespace("stats")
if(p0_e1 < 0 || p0_e1 > 1){
stop("The probability of observing the event E1 (p_e1) must be a number between 0 and 1")
}else if(p0_e2 < 0 || p0_e2 > 1){
stop("The probability of observing the event E2 (p_e2) must be a number between 0 and 1")
}else if(HR_e1 < 0 || HR_e1 > 1){
stop("The hazard ratio for the relevant endpoint E1 (HR_e1) must be a number between 0 and 1")
}else if(HR_e2 < 0 || HR_e2 > 1){
stop("The hazard ratio for the secondary endpoint E2 (HR_e2) must be a number between 0 and 1")
}else if(beta_e1 <= 0){
stop("The shape parameter for the marginal weibull distribution of the relevant endpoint E1 (beta_e1) must be a positive number")
}else if(beta_e2 <= 0){
stop("The shape parameter for the marginal weibull distribution of the secondary endpoint E2 (beta_e2) must be a positive number")
}else if(!case %in% 1:4){
stop("The case (case) must be a number in {1,2,3,4}. See ?effectsize_tte")
}else if(!copula %in% c('Frank','Gumbel','Clayton')){
stop("The copula (copula) must be one of 'Frank','Gumbel','Clayton'")
}else if(rho < -1 || rho > 1){
stop("The correlation (rho) must be a number between -1 and 1")
}else if(!rho_type %in% c('Spearman','Kendall')){
stop("The correlation type (rho_type) must be one of 'Spearman' or 'Kendall'")
}else if(alpha<=0 || alpha>=1){
stop("The probability of type I error (alpha) must be a numeric value between 0 and 1")
}else if(power<=0 || power>=1){
stop("The power must be a numeric value between 0 and 1")
}else if(!ss_formula %in% c('schoendfeld','freedman')){
stop("The selected formula (ss_formula) must be one of 'schoendfeld' (default) or 'freedman'")
}
invisible(capture.output(eff_size <- effectsize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1, beta_e2, case, copula, rho, rho_type, subdivisions=1000,plot_res = FALSE)))
gAHR <- eff_size$effect_size$gAHR
##-- Events
events_1 <- ifelse(ss_formula=='schoendfeld',
schoendfeld_formula(alpha,power,HR_e1),
freedman_formula(alpha,power,HR_e1))
events_2 <- ifelse(ss_formula=='schoendfeld',
schoendfeld_formula(alpha,power,HR_e2),
freedman_formula(alpha,power,HR_e2))
events_c <- schoendfeld_formula(alpha,power,gAHR)
##-- Probabilities of observing the event
p1_e1 <- eff_size$measures_by_group$p_e1[2]
p1_e2 <- eff_size$measures_by_group$p_e2[2]
p0_star <- eff_size$measures_by_group$pstar[1]
p1_star <- eff_size$measures_by_group$pstar[2]
##-- Sample size
ss_1 <- as.numeric(2*ceiling(events_1/(p0_e1 + p1_e1)))
ss_2 <- as.numeric(2*ceiling(events_2/(p0_e2 + p1_e2)))
ss_c <- as.numeric(2*ceiling(events_c/(p0_star + p1_star)))
if(plot_res){
rho_seq <- seq(0.01,0.99,length=subdivisions)  # correlation where to calculate SS
ss_c_temp <- c()                               # sample size composite for each correlation
for(rho_temp in rho_seq){
invisible(capture.output(eff_size_temp <- effectsize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1, beta_e2, case, copula, rho=rho_temp, rho_type, subdivisions=1000,plot_res = FALSE)))
gAHR_temp <- eff_size_temp$effect_size$gAHR
##-- Events
events_c_temp <- schoendfeld_formula(alpha,power,gAHR_temp)
##-- Probabilities of observing the event
p0_star_temp <- eff_size_temp$measures_by_group$pstar[1]
p1_star_temp <- eff_size_temp$measures_by_group$pstar[2]
##-- Sample size
ss_c_temp[which(rho_seq==rho_temp)] <- as.numeric(2*ceiling(events_c_temp/(p0_star_temp + p1_star_temp)))
}
dd <- data.frame(rho=rho_seq, sample_size=ss_c_temp)
ggplot(dd,aes(x=rho,y=ss_c_temp)) + geom_line(color='darkblue',size=1.5)
}
##-- Output text
# cat('The total sample size required to conduct a trial with the first component is',format(ss_1,digits = 0,big.mark = ','),'\n',
#     'The total sample size required to conduct a trial with the second component is',format(ss_2,digits = 0,big.mark = ','),'\n',
#     'The total sample size required to conduct a trial with the composite endpoint is',format(ss_c,digits = 0,big.mark = ','),'\n')
##-- Output data.frame
df <- data.frame(Endpoint=c('--------','Endpoint 1','Endpoint 2','Composite endpoint'),
"Total sample size"=c("-----------------",ss_1,ss_2,ss_c),
check.names = FALSE)
print(df, row.names = FALSE,right=FALSE)
##-- Returned list
return(invisible(list('ss_E1' = ss_1,
'ss_E2' = ss_2,
'ss_Ec' = ss_c)))
}
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld',plot_res=TRUE)
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld',plot_res=TRUE)
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld',plot_res=TRUE)
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld',plot_res=TRUE)
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
library(gridExtra) ##--> Falta incluirla en el paquete!
##-- Parameters
p1=p0_e1=.59#0.2
p2=p0_e2=.74#0.2
HR1=HR_e1=.91#0.9
HR2=HR_e2=.77#0.6
beta1=beta_e1=1#0.5
beta2=beta_e2=2#0.5
case = 3#4
copula='Frank'
rho = 0.5#0.7
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/My Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld',plot_res=TRUE)
